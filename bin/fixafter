#!/bin/sh

DD=$(pwd)

find . -type d \( \( -name CVS -prune \) -o -print \) |
while read a ; do if test ! -d $a/CVS ; then cd $(dirname $a); cvs add $(basename $a) ; cd $DD; fi; done

dr=.
find . \( -name CVS -prune \) -o \( -size 0 -name \*.orig -print \) |
while read a ; do ndr=$(dirname $a); if test $dr != $ndr; then echo "## $ndr:"; dr=$ndr; cd $DD; cd $dr; fi; rm $(basename $a); cvs add $(basename $a .orig) || true ; done
cd $DD

dr=.
find . \( -name CVS -prune \) -o \( -size 0               -print \) |
while read a ; do ndr=$(dirname $a); if test $dr != $ndr; then echo "## $ndr:"; dr=$ndr; cd $DD; cd $dr; fi; rm $(basename $a); cvs rm  $(basename $a      )         ; done
cd $DD

find . \( -name CVS -prune \) -o \(         -name \*.rej  -print \) |
while read a ; do echo "$a ### FAILED" ; done

